var CrsaUndoState=function(t,e){var n=[];n.push({obj:t,data:t.getSource()});for(var a=getCrsaPageStylesForPage(t.$iframe),o=0;o<a.stylesheets.length;o++){var r=a.stylesheets[o];r.inline||r.loaded&&n.push({obj:r,data:r.genGetSource()})}n.push({obj:"breakpoints",data:t.breakpoints.slice(0)}),this.page=t,this.data=n,this.name=e,this.active=!0;var s=this;this.apply=function(t){for(var e=0,n=null,a=0;a<this.data.length;a++){var o=this.data[a];"breakpoints"===o.obj?n.obj.breakpoints=o.data:o.obj instanceof CrsaPage?n=o:o.obj instanceof CrsaStylesheet&&(e++,o.obj.changed=!0,o.obj.genSetSource(o.data,function(){e--,0==e&&n.obj.setSource(n.data,function(){t&&t(s)})},!0))}0==e&&n&&n.obj.setSource(n.data,function(){t&&t(s)})}},CrsaPageUndoStack=function(t){var e=[],n=-1,a="undo";this.page=t,this.add=function(t,a){var o=new CrsaUndoState(this.page,t);if(e.length>n+1&&e.splice(n+1,e.length-(n+1)),e.push(o),!a){n++;var r=20;if(n>r){var s=n-r;e.splice(0,s),n-=s,console.log("Cleared "+s+" from undo stack")}}return o},this.isAtTheTip=function(){return n>=0&&e.length==n+1},this.remove=function(){return 0>n?null:(n--,e.splice(n+1,1),void 0)},this.undo=function(t){var o="undo"==a?0:1;if(0+o>n)return t&&t(null),null;"undo"!=a&&(n-=1);var r=e[n];return n-=1,r.apply(t),a="undo",r},this.redo=function(t){var o="undo"==a?2:1;if(n+o>=e.length)return t&&t(null),null;n+=o;var r=e[n];return r.apply(t),a="redo",r}},CrsaUndo=function(){};